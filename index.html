<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mobile PDF & Image Toolbox</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<style>
html, body { margin:0; padding:0; width:100%; font-family:Arial,sans-serif; background:#f9fafb; display:flex; flex-direction:column; align-items:center;}
header { background: linear-gradient(135deg, #4f46e5, #3b82f6); color:white; text-align:center; padding:1rem; width:100%; border-radius:0 0 1rem 1rem;}
main { width:100%; max-width:420px; padding:1rem; display:flex; flex-direction:column; gap:1rem;}
.card { background:white; border-radius:1rem; padding:1rem; box-shadow:0 4px 12px rgba(0,0,0,0.15); display:flex; flex-direction:column; gap:0.5rem;}
select,input,button { padding:0.75rem; border-radius:0.75rem; border:1px solid #d1d5db; font-size:1rem; width:100%; box-sizing:border-box;}
button { background: linear-gradient(135deg, #3b82f6, #2563eb); color:white; border:none; font-weight:bold; cursor:pointer; transition:0.3s;}
button:hover { background: linear-gradient(135deg, #2563eb, #1d4ed8);}
.file-list { display:flex; flex-wrap:wrap; gap:0.5rem; }
.thumb { width:80px; height:80px; object-fit:cover; border-radius:1rem; box-shadow:0 2px 6px rgba(0,0,0,0.1);}
.output-button { margin-top:0.5rem; }
.hidden { display:none; }
</style>
</head>
<body>
<header>
  <h1>ðŸ“„ Mobile PDF & Image Toolbox</h1>
</header>
<main>
  <div class="card">
    <label for="operation">Choose Operation:</label>
    <select id="operation">
      <option value="images-to-pdf">Images â†’ PDF</option>
      <option value="merge-pdf">Merge PDFs</option>
      <option value="pdf-to-images">PDF â†’ Images</option>
      <option value="split-pdf">Split PDF</option>
      <option value="convert-images">Convert Images</option>
    </select>
    <input type="file" id="file-input" multiple>
    
    <div id="image-format-group" class="hidden">
      <label for="image-format">Output Image Format:</label>
      <select id="image-format">
        <option value="image/png">PNG</option>
        <option value="image/jpeg">JPEG</option>
        <option value="image/webp">WEBP</option>
      </select>
    </div>
    
    <div id="page-range-group" class="hidden">
      <label for="page-range">Page numbers (e.g., 1,3-5):</label>
      <input type="text" id="page-range" placeholder="Enter page numbers">
    </div>
    
    <div class="file-list" id="file-list"></div>
    
    <div style="display:flex; gap:0.5rem;">
      <button id="run-btn" style="flex:1;">Run</button>
      <button id="clear-btn" style="flex:1; background:#e5e7eb; color:#111;">Clear</button>
    </div>
    
    <div id="output"></div>
  </div>
</main>
<script>
const fileInput = document.getElementById('file-input');
const fileList = document.getElementById('file-list');
const runBtn = document.getElementById('run-btn');
const clearBtn = document.getElementById('clear-btn');
const output = document.getElementById('output');
const operation = document.getElementById('operation');
const imgFormatGroup = document.getElementById('image-format-group');
const pageRangeGroup = document.getElementById('page-range-group');

const imageFormat = document.getElementById('image-format');
const pageRange = document.getElementById('page-range');

let selectedFiles = [];

// Show/hide extra inputs based on operation
operation.addEventListener('change', () => {
  imgFormatGroup.classList.toggle('hidden', !(operation.value === 'convert-images' || operation.value === 'pdf-to-images'));
  pageRangeGroup.classList.toggle('hidden', !(operation.value === 'split-pdf' || operation.value === 'pdf-to-images' || operation.value === 'convert-images'));
});

// File previews
fileInput.addEventListener('change', () => {
  selectedFiles = Array.from(fileInput.files);
  renderPreviews();
});

function renderPreviews() {
  fileList.innerHTML = '';
  selectedFiles.forEach(file => {
    if(file.type.startsWith('image/')){
      const img = document.createElement('img');
      img.src = URL.createObjectURL(file);
      img.className = 'thumb';
      fileList.appendChild(img);
    } else {
      const div = document.createElement('div');
      div.textContent = file.name;
      div.style.padding = '0.5rem';
      div.style.border = '1px solid #ddd';
      div.style.borderRadius = '1rem';
      fileList.appendChild(div);
    }
  });
}

// Clear button
clearBtn.addEventListener('click', () => {
  fileInput.value = '';
  selectedFiles = [];
  fileList.innerHTML = '';
  output.innerHTML = '';
});

// Redirect/Ad button
function createRedirectButton(filename){
  const btn = document.createElement('button');
  btn.textContent = `Download ${filename}`;
  btn.className = 'output-button';
  btn.onclick = () => {
    window.open('https://www.revenuecpmgate.com/fbyyztty18?key=6c3998ad2f11ef07adf8fa3618a2702d', '_blank'); // Replace with your link
  };
  return btn;
}

// Parse page range input (e.g., "1,3-5")
function parsePageNumbers(str) {
  const pages = new Set();
  if(!str) return pages;
  str.split(',').forEach(part => {
    if(part.includes('-')){
      const [start,end] = part.split('-').map(Number);
      for(let i=start;i<=end;i++) pages.add(i-1);
    } else {
      pages.add(Number(part)-1);
    }
  });
  return pages;
}

// Run button
runBtn.addEventListener('click', async () => {
  if(selectedFiles.length === 0) { alert('Please select files'); return; }
  output.innerHTML = '';
  const op = operation.value;
  
  // Images â†’ PDF
  if(op === 'images-to-pdf'){
    const pdfDoc = await PDFLib.PDFDocument.create();
    for(let file of selectedFiles){
      if(!file.type.startsWith('image/')) continue;
      const bytes = await file.arrayBuffer();
      let img = file.type === 'image/png' ? await pdfDoc.embedPng(bytes) : await pdfDoc.embedJpg(bytes);
      const page = pdfDoc.addPage([1080,1920]);
      page.drawImage(img, {x:0,y:0,width:1080,height:1920});
    }
    output.appendChild(createRedirectButton('output.pdf'));
  }

  // Merge PDFs
  else if(op === 'merge-pdf'){
    const mergedPdf = await PDFLib.PDFDocument.create();
    for(let file of selectedFiles){
      if(file.type !== 'application/pdf') continue;
      const bytes = await file.arrayBuffer();
      const pdf = await PDFLib.PDFDocument.load(bytes);
      const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
      copiedPages.forEach(p => mergedPdf.addPage(p));
    }
    output.appendChild(createRedirectButton('merged.pdf'));
  }

  // PDF â†’ Images
  else if(op === 'pdf-to-images'){
    alert('PDF â†’ Images conversion will need server-side processing or a library like pdf.js. Telegram-compatible download requires a server link.');
    output.appendChild(createRedirectButton('pdf-pages.zip'));
  }

  // Split PDF
  else if(op === 'split-pdf'){
    alert('Split PDF requires server-side handling to generate individual PDFs per page. Redirect download can be provided.');
    output.appendChild(createRedirectButton('split-files.zip'));
  }

  // Convert Images
  else if(op === 'convert-images'){
    const format = imageFormat.value;
    alert(`Images will be converted to ${format}. Telegram-compatible download requires a server link.`);
    output.appendChild(createRedirectButton(`images.${format.split('/')[1]}`));
  }
});
</script>
</body>
</html>
